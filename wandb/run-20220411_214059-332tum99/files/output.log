
Buckle up, here with start the journey🚲
----------------------ready to use dataset--------------
Found already existing npy
shape of Xs_train:  (3610, 3, 256, 256)
shape of Ys_train:  (3610, 1, 256, 256)
shape of Xt_train:  (3610, 3, 256, 256)
shape of Yt_train:  (3610, 1, 256, 256)
--------------------------------------------------------------------
Number of source training examples: 2166
Number of source validation examples: 1444
Finally atleast train and valid source dataloader section works 😌
--------------------------------------------------------------------
 Shape of Xt_train is:(3610, 3, 256, 256)
  1%|▊                                                                                                                       | 1/140 [00:00<01:19,  1.74it/s]
--------------------------------------------------------------------
Number of target training examples: 2166
Number of target validation examples: 1444
Finally atleast train and valid target dataloader section works 😌
length of train source:136, lenth of train target is 136
length of validation source:91, lenth of validation target is 91
The model has 32,521,105 trainable parameters








































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 140/140 [01:22<00:00,  1.69it/s]
  0%|                                                                                                                                | 0/140 [00:00<?, ?it/s]
Training loss in average for epoch 1 is 560.548818269372
Training F1 in average for epoch 1 is 0.47693655852760586
Training Accuracy in average for epoch 1 is 0.6340712479182652
Training IOU in average for epoch 1 is 0.31582835550819127
Training K in average for epoch 1 is 1.363942105429513












 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████      | 133/140 [00:24<00:01,  5.54it/s]
Evaluation loss in average for epoch 1 is 0.8286525130271911
Evaluation F1 in average for epoch 1 is 0.5285570632134166
Evaluation Accuracy in average for epoch 1 is 0.7886865139007568
Evaluation IOU in average for epoch 1 is 0.36191466812576567
Evaluation K in average for epoch 1 is 1.2290412255695888
last learning rate: [0.005] LR: [0.005]
###################### Early stopping ##########################
The current validation loss: 0.8286525130271911
trigger times: 0
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 140/140 [00:25<00:00,  5.52it/s]
/share/projects/erasmus/pratichhya_sharma/app/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:416: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.
  warnings.warn("To get the last learning rate computed by the scheduler, "








































 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎ | 138/140 [01:21<00:01,  1.70it/s]
Training loss in average for epoch 2 is 0.6992088922432491
Training F1 in average for epoch 2 is 0.5198556580713817
Training Accuracy in average for epoch 2 is 0.6775659765516009
Training IOU in average for epoch 2 is 0.35362584803785596
Training K in average for epoch 2 is 1.3441449352673123
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 140/140 [01:22<00:00,  1.70it/s]











 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 135/140 [00:22<00:00,  5.97it/s]
Evaluation loss in average for epoch 2 is 0.6954756289720535
Evaluation F1 in average for epoch 2 is 0.5728465674178941
Evaluation Accuracy in average for epoch 2 is 0.7522752012525286
Evaluation IOU in average for epoch 2 is 0.4038155943155289
Evaluation K in average for epoch 2 is 1.2980023971625736
last learning rate: [0.005] LR: [0.005]
###################### Early stopping ##########################
The current validation loss: 0.6954756289720535
trigger times: 0
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 140/140 [00:23<00:00,  5.94it/s]








































 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏| 139/140 [01:21<00:00,  1.71it/s]
Training loss in average for epoch 3 is 0.6183227500745229
Training F1 in average for epoch 3 is 0.49748357598270687
Training Accuracy in average for epoch 3 is 0.6156568595341274
Training IOU in average for epoch 3 is 0.3340864955314568
Training K in average for epoch 3 is 1.3226768238203865
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 140/140 [01:22<00:00,  1.70it/s]










100%|█████████████████████████████████████████████████████████████████████████████████| 140/140 [00:23<00:00,  5.88it/s]
  0%|                                                                                           | 0/140 [00:00<?, ?it/s]
Evaluation loss in average for epoch 3 is 0.6549563531364714
Evaluation F1 in average for epoch 3 is 0.5489341882722718
Evaluation Accuracy in average for epoch 3 is 0.7531792095729283
Evaluation IOU in average for epoch 3 is 0.3799914204648563
Evaluation K in average for epoch 3 is 1.3008135216576713
last learning rate: [0.005] LR: [0.005]
###################### Early stopping ##########################
The current validation loss: 0.6549563531364714
trigger times: 0








































 98%|███████████████████████████████████████████████████████████████████████████████▎ | 137/140 [01:20<00:01,  1.70it/s]
Training loss in average for epoch 4 is 0.5861554290567126
Training F1 in average for epoch 4 is 0.45436067868556296
Training Accuracy in average for epoch 4 is 0.5240690299442836
Training IOU in average for epoch 4 is 0.2973413276885237
Training K in average for epoch 4 is 1.2706948484693255
100%|█████████████████████████████████████████████████████████████████████████████████| 140/140 [01:22<00:00,  1.70it/s]











 95%|████████████████████████████████████████████████████████████████████████████▉    | 133/140 [00:22<00:01,  5.94it/s]
Evaluation loss in average for epoch 4 is 0.7017970838717051
Evaluation F1 in average for epoch 4 is 0.48739512243441174
Evaluation Accuracy in average for epoch 4 is 0.6411071368626186
Evaluation IOU in average for epoch 4 is 0.32406484495316235
Evaluation K in average for epoch 4 is 1.3644204565456934
last learning rate: [0.005] LR: [0.005]
###################### Early stopping ##########################

100%|█████████████████████████████████████████████████████████████████████████████████| 140/140 [00:23<00:00,  5.93it/s]
trigger times: 1
----------------------Traning phase-----------------------------








































 99%|████████████████████████████████████████████████████████████████████████████████▍| 139/140 [01:21<00:00,  1.70it/s]
Training loss in average for epoch 5 is 0.524533574283123
Training F1 in average for epoch 5 is 0.37932861468621665
Training Accuracy in average for epoch 5 is 0.3115504128592355
Training IOU in average for epoch 5 is 0.23601113972919327
Training K in average for epoch 5 is 1.0958753389971596
100%|█████████████████████████████████████████████████████████████████████████████████| 140/140 [01:22<00:00,  1.70it/s]











 99%|████████████████████████████████████████████████████████████████████████████████▍| 139/140 [00:23<00:00,  5.93it/s]
Evaluation loss in average for epoch 5 is 0.5969941956656319
Evaluation F1 in average for epoch 5 is 0.5930737555027008
Evaluation Accuracy in average for epoch 5 is 0.7819175583975656
Evaluation IOU in average for epoch 5 is 0.4233362653425762
Evaluation K in average for epoch 5 is 1.2643402704170772
last learning rate: [0.005] LR: [0.005]
###################### Early stopping ##########################
The current validation loss: 0.5969941956656319
trigger times: 1
100%|█████████████████████████████████████████████████████████████████████████████████| 140/140 [00:23<00:00,  5.93it/s]







































100%|█████████████████████████████████████████████████████████████████████████████████| 140/140 [01:22<00:00,  1.70it/s]
  0%|                                                                                           | 0/140 [00:00<?, ?it/s]
Training loss in average for epoch 6 is 0.5083051796470369
Training F1 in average for epoch 6 is 0.36306733882852965
Training Accuracy in average for epoch 6 is 0.2615717819758824
Training IOU in average for epoch 6 is 0.22372712519552027
Training K in average for epoch 6 is 1.0485841998032162











 94%|████████████████████████████████████████████████████████████████████████████▎    | 132/140 [00:22<00:01,  5.93it/s]
Evaluation loss in average for epoch 6 is 0.6492823098387037
Evaluation F1 in average for epoch 6 is 0.6083632494722094
Evaluation Accuracy in average for epoch 6 is 0.7988940170833043
Evaluation IOU in average for epoch 6 is 0.43859185640301024
Evaluation K in average for epoch 6 is 1.2410244396754673
last learning rate: [0.005] LR: [0.005]
###################### Early stopping ##########################

100%|█████████████████████████████████████████████████████████████████████████████████| 140/140 [00:23<00:00,  5.92it/s]
trigger times: 2
----------------------Traning phase-----------------------------








































 99%|████████████████████████████████████████████████████████████████████████████████▍| 139/140 [01:21<00:00,  1.70it/s]
Training loss in average for epoch 7 is 0.5117201732737677
Training F1 in average for epoch 7 is 0.4050035599086966
Training Accuracy in average for epoch 7 is 0.3605014528547015
Training IOU in average for epoch 7 is 0.2594780970896993
Training K in average for epoch 7 is nan
100%|█████████████████████████████████████████████████████████████████████████████████| 140/140 [01:22<00:00,  1.70it/s]










100%|█████████████████████████████████████████████████████████████████████████████████| 140/140 [00:23<00:00,  5.93it/s]
  0%|                                                                                           | 0/140 [00:00<?, ?it/s]
Evaluation loss in average for epoch 7 is 0.7640310700450624
Evaluation F1 in average for epoch 7 is 0.41131797624485833
Evaluation Accuracy in average for epoch 7 is 0.4075730732509068
Evaluation IOU in average for epoch 7 is 0.26069470484341895
Evaluation K in average for epoch 7 is 1.1855597300188883
last learning rate: [0.005] LR: [0.005]
###################### Early stopping ##########################
The current validation loss: 0.7640310700450624
trigger times: 3









































 99%|████████████████████████████████████████████████████████████████████████████████▍| 139/140 [01:21<00:00,  1.70it/s]
Training loss in average for epoch 8 is 0.47629044502973555
Training F1 in average for epoch 8 is 0.35069326662591527
Training Accuracy in average for epoch 8 is 0.2142834254673549
Training IOU in average for epoch 8 is 0.21420540234872273
Training K in average for epoch 8 is nan
100%|█████████████████████████████████████████████████████████████████████████████████| 140/140 [01:22<00:00,  1.70it/s]










 94%|███████████████████████████████████████████████████████████████████████████▊     | 131/140 [00:21<00:01,  5.95it/s]
Evaluation loss in average for epoch 8 is 0.7303765888725008
Evaluation F1 in average for epoch 8 is 0.42720414506537574
Evaluation Accuracy in average for epoch 8 is 0.4566243512289865
Evaluation IOU in average for epoch 8 is 0.273217977051224
Evaluation K in average for epoch 8 is 1.231401616334915
last learning rate: [0.005] LR: [0.005]
###################### Early stopping ##########################
The current validation loss: 0.7303765888725008
trigger times: 4
100%|█████████████████████████████████████████████████████████████████████████████████| 140/140 [00:23<00:00,  5.96it/s]








































 99%|███████████████████████████████████████████████████████████████████████████████▊ | 138/140 [01:21<00:01,  1.70it/s]
Training loss in average for epoch 9 is 0.5107532035027231
Training F1 in average for epoch 9 is 0.4422032419059958
Training Accuracy in average for epoch 9 is 0.481770304271153
Training IOU in average for epoch 9 is 0.2894178904060807
Training K in average for epoch 9 is nan
100%|█████████████████████████████████████████████████████████████████████████████████| 140/140 [01:22<00:00,  1.70it/s]











 98%|███████████████████████████████████████████████████████████████████████████████▎ | 137/140 [00:23<00:00,  5.97it/s]
Evaluation loss in average for epoch 9 is 0.5650538025157792
Evaluation F1 in average for epoch 9 is 0.6081604580794062
Evaluation Accuracy in average for epoch 9 is 0.7880426202501569
Evaluation IOU in average for epoch 9 is 0.4394233052219663
Evaluation K in average for epoch 9 is 1.2570852611746106
last learning rate: [0.005] LR: [0.005]
###################### Early stopping ##########################
The current validation loss: 0.5650538025157792
trigger times: 4
100%|█████████████████████████████████████████████████████████████████████████████████| 140/140 [00:23<00:00,  5.93it/s]












 32%|██████████████████████████▎                                                       | 45/140 [00:27<00:57,  1.66it/s]
Traceback (most recent call last):
  File "/share/mastoc/projects/erasmus/pratichhya_sharma/DAoptim/DAoptim/main.py", line 163, in <module>
    main(net)
  File "/share/mastoc/projects/erasmus/pratichhya_sharma/DAoptim/DAoptim/main.py", line 107, in main
    train_loss, acc_mat = Train.train_epoch(net,optimizer, source_dataloader, target_dataloader)
  File "/share/mastoc/projects/erasmus/pratichhya_sharma/DAoptim/DAoptim/train.py", line 122, in train_epoch
    torch.cuda.empty_cache()
  File "/share/projects/erasmus/pratichhya_sharma/app/lib/python3.9/site-packages/torch/cuda/memory.py", line 114, in empty_cache
    torch._C._cuda_emptyCache()
KeyboardInterrupt